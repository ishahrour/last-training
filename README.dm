This code is only for training